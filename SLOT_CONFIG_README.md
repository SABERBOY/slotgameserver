# 通用Slot配置系统使用指南

## 概述

本系统实现了一个通用的老虎机（Slot）游戏架构，支持：
- **n×m形式**：可配置任意行数和卷轴数
- **Megaway模式**：每个卷轴的行数可以动态变化
- **自定义符号**：支持普通符号、Wild、Scatter、Bonus等类型
- **灵活的支付线**：可自定义支付线模式
- **网页管理后台**：通过Web界面轻松管理所有配置

## 快速开始

### 1. 访问管理后台

启动服务器后，访问：`http://localhost:8000/admin`

### 2. 创建新的Slot配置

1. 点击"创建配置"标签
2. 填写基本信息：
   - **配置名称**：如 "Lucky 777"
   - **行数**：标准为3行
   - **卷轴数**：标准为5个卷轴
   - **Megaway模式**：勾选启用动态行数
   - **赌注范围**：设置最小和最大赌注
   - **RTP百分比**：设置理论返还率

### 3. 添加符号

1. 切换到"符号管理"标签
2. 选择刚创建的配置
3. 添加符号：
   ```
   普通符号示例：
   - Cherry (价值:1, 3x:5, 4x:10, 5x:20)
   - Lemon  (价值:2, 3x:10, 4x:20, 5x:40)
   - Orange (价值:3, 3x:15, 4x:30, 5x:60)
   
   特殊符号：
   - Wild (类型:wild, 可替代其他符号)
   - Scatter (类型:scatter, 触发免费旋转)
   ```

### 4. 配置卷轴

1. 切换到"卷轴管理"标签
2. 为每个卷轴的每个位置分配符号
3. 设置权重（权重越高，出现概率越大）

示例配置：
```
卷轴0，位置0-19：
- Cherry (权重:3) - 高频出现
- Seven  (权重:1) - 低频出现
- Wild   (权重:1) - 稀有
```

### 5. 设置支付线

1. 切换到"支付线管理"标签
2. 添加支付线模式

常见支付线模式：
```
横线：     0,0 1,0 2,0 3,0 4,0 (第一行)
          0,1 1,1 2,1 3,1 4,1 (第二行)
          0,2 1,2 2,2 3,2 4,2 (第三行)

V形：      0,0 1,1 2,2 3,1 4,0
倒V形：    0,2 1,1 2,0 3,1 4,2

之字形：   0,1 1,0 2,1 3,2 4,1
```

### 6. 测试旋转

1. 切换到"测试旋转"标签
2. 选择配置
3. 设置赌注
4. 点击"旋转"查看结果

## API使用

### 创建Slot配置
```bash
POST /api/slot-config
Content-Type: application/json

{
  "name": "My Slot Game",
  "rows": 3,
  "reels": 5,
  "is_megaway": false,
  "min_megaway_rows": 2,
  "max_megaway_rows": 7,
  "default_bet": 1,
  "min_bet": 1,
  "max_bet": 1000,
  "wild_enabled": true,
  "free_spins_enabled": true,
  "rtp_percentage": 96.5
}
```

### 执行旋转
```bash
POST /api/slot-config/spin
Content-Type: application/json

{
  "slot_config_id": 1,
  "bet_per_line": 10
}
```

## Megaway模式说明

Megaway模式的特点：
- 每个卷轴的行数在每次旋转时随机决定（2-7行）
- 获胜方式数量 = 各卷轴行数的乘积
- 例如：3×4×5×6×7 = 2,520种获胜方式
- 从左到右相邻卷轴的相同符号即可获胜

## 数据库初始化

运行初始化脚本创建示例配置：
```bash
psql -U postgres -d your_database < init_slot_config.sql
```

这将创建：
- 一个标准5×3水果主题老虎机
- 一个6×6 Megaway宝石主题老虎机

## 性能优化建议

1. **符号权重**：合理设置权重以控制RTP
2. **支付线数量**：过多支付线会影响计算性能
3. **Megaway路径**：大型Megaway配置会产生大量路径，注意性能

## 常见问题

**Q: 如何调整RTP？**
A: 通过调整符号权重、赔付倍数和特殊符号出现率

**Q: Megaway最多支持多少行？**
A: 理论上无限制，但建议不超过7行以保证性能

**Q: 可以添加多少个符号？**
A: 建议每个配置不超过15个不同符号

## 扩展开发

系统提供了完整的API，可以：
- 集成到现有游戏平台
- 开发移动端应用
- 添加动画和音效
- 实现多币种支持
- 添加锦标赛功能